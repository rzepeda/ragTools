✓ Virtual environment activated
✓ Environment variables loaded from .env
  EMBEDDING_MODEL_NAME: Xenova/all-mpnet-base-v2
  EMBEDDING_MODEL_PATH: models/embedding

Running tests...
Output will be saved to: test_results.txt

============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.1, pluggy-1.6.0 -- /mnt/MCPProyects/ragTools/venv/bin/python3
cachedir: .pytest_cache
rootdir: /mnt/MCPProyects/ragTools
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.0, cov-7.0.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 110 items

tests/integration/strategies/test_base_integration.py::test_strategy_full_lifecycle FAILED [  0%]
tests/integration/strategies/test_base_integration.py::test_multiple_strategies_implement_interface FAILED [  1%]
tests/integration/strategies/test_base_integration.py::test_async_retrieve_works FAILED [  2%]
tests/integration/strategies/test_base_integration.py::test_strategy_error_handling FAILED [  3%]
tests/integration/strategies/test_base_integration.py::test_strategy_configuration_override FAILED [  4%]
tests/integration/strategies/test_chunking_integration.py::test_structural_chunking_markdown_document PASSED [  5%]
tests/integration/strategies/test_chunking_integration.py::test_structural_chunking_plain_text PASSED [  6%]
tests/integration/strategies/test_chunking_integration.py::test_structural_chunking_code_blocks PASSED [  7%]
tests/integration/strategies/test_chunking_integration.py::test_fixed_size_chunking_consistency PASSED [  8%]
tests/integration/strategies/test_chunking_integration.py::test_compare_chunking_strategies PASSED [  9%]
tests/integration/strategies/test_chunking_integration.py::test_chunking_empty_document PASSED [ 10%]
tests/integration/strategies/test_chunking_integration.py::test_chunking_very_long_document PASSED [ 10%]
tests/integration/strategies/test_chunking_integration.py::test_chunking_with_special_characters PASSED [ 11%]
tests/integration/strategies/test_chunking_integration.py::test_batch_document_processing PASSED [ 12%]
tests/integration/strategies/test_chunking_integration.py::test_chunk_metadata_completeness PASSED [ 13%]
tests/integration/strategies/test_chunking_integration.py::test_chunk_validation PASSED [ 14%]
tests/integration/strategies/test_chunking_integration.py::test_get_stats_functionality PASSED [ 15%]
tests/integration/strategies/test_contextual_integration.py::test_contextual_retrieval_complete_workflow FAILED [ 16%]
tests/integration/strategies/test_contextual_integration.py::test_cost_tracking_accuracy FAILED [ 17%]
tests/integration/strategies/test_contextual_integration.py::test_retrieval_with_different_formats FAILED [ 18%]
tests/integration/strategies/test_contextual_integration.py::test_error_recovery FAILED [ 19%]
tests/integration/strategies/test_contextual_integration.py::test_synchronous_indexing FAILED [ 20%]
tests/integration/strategies/test_contextual_integration.py::test_large_document_processing FAILED [ 20%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_produces_capabilities PASSED [ 21%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_requires_services PASSED [ 22%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_process_basic_document PASSED [ 23%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_process_document_with_headings PASSED [ 24%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_hierarchy_metadata PASSED [ 25%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_max_depth_configuration PASSED [ 26%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_empty_document PASSED [ 27%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_multiple_documents PASSED [ 28%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_path_tracking PASSED [ 29%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_split_by_headings_markdown PASSED [ 30%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_split_by_headings_no_headings PASSED [ 30%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_split_by_paragraphs PASSED [ 31%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_split_by_paragraphs_single PASSED [ 32%]
tests/integration/strategies/test_hierarchical_indexing.py::TestHierarchicalIndexing::test_document_metadata_preserved PASSED [ 33%]
tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_end_to_end_workflow FAILED [ 34%]
tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_expansion_strategy_comparison FAILED [ 35%]
tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_hierarchy_validation FAILED [ 36%]
tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_multiple_documents FAILED [ 37%]
tests/integration/strategies/test_in_memory_indexing.py::test_capabilities PASSED [ 38%]
tests/integration/strategies/test_in_memory_indexing.py::test_dependencies PASSED [ 39%]
tests/integration/strategies/test_in_memory_indexing.py::test_process_success PASSED [ 40%]
tests/integration/strategies/test_in_memory_indexing.py::test_storage_operations PASSED [ 40%]
tests/integration/strategies/test_in_memory_indexing.py::test_clear_storage PASSED [ 41%]
tests/integration/strategies/test_in_memory_indexing.py::test_get_chunk PASSED [ 42%]
tests/integration/strategies/test_in_memory_indexing.py::test_multiple_documents PASSED [ 43%]
tests/integration/strategies/test_in_memory_indexing.py::test_empty_documents PASSED [ 44%]
tests/integration/strategies/test_in_memory_indexing.py::test_custom_chunk_size PASSED [ 45%]
tests/integration/strategies/test_in_memory_indexing.py::test_chunk_metadata_preservation PASSED [ 46%]
tests/integration/strategies/test_in_memory_indexing.py::test_shared_storage_across_instances PASSED [ 47%]
tests/integration/strategies/test_in_memory_indexing.py::test_document_without_id PASSED [ 48%]
tests/integration/strategies/test_keyword_indexing.py::test_capabilities ERROR [ 49%]
tests/integration/strategies/test_keyword_indexing.py::test_dependencies ERROR [ 50%]
tests/integration/strategies/test_keyword_indexing.py::test_process_success ERROR [ 50%]
tests/integration/strategies/test_keyword_indexing.py::test_process_no_chunks ERROR [ 51%]
tests/integration/strategies/test_keyword_indexing.py::test_process_empty_text ERROR [ 52%]
tests/integration/strategies/test_keyword_indexing.py::test_process_stop_words_only ERROR [ 53%]
tests/integration/strategies/test_knowledge_graph_integration.py::test_knowledge_graph_workflow FAILED [ 54%]
tests/integration/strategies/test_knowledge_graph_integration.py::test_hybrid_retrieval FAILED [ 55%]
tests/integration/strategies/test_knowledge_graph_integration.py::test_relationship_queries FAILED [ 56%]
tests/integration/strategies/test_knowledge_graph_integration.py::test_graph_statistics FAILED [ 57%]
tests/integration/strategies/test_late_chunking_integration.py::test_late_chunking_workflow FAILED [ 58%]
tests/integration/strategies/test_late_chunking_integration.py::test_fixed_size_chunking_integration PASSED [ 59%]
tests/integration/strategies/test_late_chunking_integration.py::test_adaptive_chunking_integration PASSED [ 60%]
tests/integration/strategies/test_late_chunking_integration.py::test_multiple_documents FAILED [ 60%]
tests/integration/strategies/test_late_chunking_integration.py::test_strategy_properties PASSED [ 61%]
tests/integration/strategies/test_late_chunking_integration.py::test_coherence_scores_computed PASSED [ 62%]
tests/integration/strategies/test_late_chunking_integration.py::test_short_document FAILED [ 63%]
tests/integration/strategies/test_late_chunking_integration.py::test_chunk_embeddings_valid PASSED [ 64%]
tests/integration/strategies/test_late_chunking_integration.py::test_embedding_quality PASSED [ 65%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_multi_query_complete_workflow FAILED [ 66%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_multi_query_async_workflow FAILED [ 67%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_variant_diversity FAILED [ 68%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_performance_requirements FAILED [ 69%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_fallback_on_failure FAILED [ 70%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_ranking_strategy_comparison FAILED [ 70%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_deduplication_across_variants FAILED [ 71%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_strategy_properties FAILED [ 72%]
tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryWithLMStudio::test_with_real_llm FAILED [ 73%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_keyword_expansion_real_llm PASSED [ 74%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_query_reformulation PASSED [ 75%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_question_generation PASSED [ 76%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_hyde_expansion PASSED [ 77%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_multi_query_generation PASSED [ 78%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_expansion_performance PASSED [ 79%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_cache_functionality FAILED [ 80%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_ab_testing_functionality PASSED [ 80%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_domain_context PASSED [ 81%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_error_handling_fallback PASSED [ 82%]
tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_stats_tracking PASSED [ 83%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_end_to_end_reranking PASSED [ 84%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_performance_with_many_candidates PASSED [ 85%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_cache_effectiveness PASSED [ 86%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_score_threshold_filtering PASSED [ 87%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_ranking_position_tracking PASSED [ 88%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_fallback_preserves_order PASSED [ 89%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_batch_processing PASSED [ 90%]
tests/integration/strategies/test_reranking_integration.py::TestMockRerankerIntegration::test_statistics_accumulation PASSED [ 90%]
tests/integration/strategies/test_reranking_integration.py::TestRealCrossEncoderIntegration::test_real_model_reranking SKIPPED [ 91%]
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_end_to_end_workflow PASSED [ 92%]
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_retry_with_poor_results PASSED [ 93%]
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_performance_within_limits PASSED [ 94%]
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveWithLMStudio::test_with_real_llm PASSED [ 95%]
tests/integration/strategies/test_vector_embedding_indexing.py::TestVectorEmbeddingIndexing::test_capabilities_and_dependencies PASSED [ 96%]
tests/integration/strategies/test_vector_embedding_indexing.py::TestVectorEmbeddingIndexing::test_process_success PASSED [ 97%]
tests/integration/strategies/test_vector_embedding_indexing.py::TestVectorEmbeddingIndexing::test_process_batching PASSED [ 98%]
tests/integration/strategies/test_vector_embedding_indexing.py::TestVectorEmbeddingIndexing::test_no_chunks_error PASSED [ 99%]
tests/integration/strategies/test_vector_embedding_indexing.py::TestVectorEmbeddingIndexing::test_service_error PASSED [100%]

==================================== ERRORS ====================================
_____________________ ERROR at setup of test_capabilities ______________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
_____________________ ERROR at setup of test_dependencies ______________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
____________________ ERROR at setup of test_process_success ____________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
___________________ ERROR at setup of test_process_no_chunks ___________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
__________________ ERROR at setup of test_process_empty_text ___________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
________________ ERROR at setup of test_process_stop_words_only ________________
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
=================================== FAILURES ===================================
E   TypeError: Can't instantiate abstract class DummyStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_base_integration.py:62: TypeError: Can't instantiate abstract class DummyStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class StrategyA without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_base_integration.py:113: TypeError: Can't instantiate abstract class StrategyA without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class AsyncStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_base_integration.py:154: TypeError: Can't instantiate abstract class AsyncStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class ErrorStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_base_integration.py:186: TypeError: Can't instantiate abstract class ErrorStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class ConfigurableStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_base_integration.py:221: TypeError: Can't instantiate abstract class ConfigurableStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:85: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:142: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:181: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:222: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:247: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_contextual_integration.py:282: TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
E   TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_hierarchical_integration.py:92: TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_hierarchical_integration.py:128: TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_hierarchical_integration.py:165: TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
E   TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_hierarchical_integration.py:181: TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
E   TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_knowledge_graph_integration.py:91: TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_knowledge_graph_integration.py:122: TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_knowledge_graph_integration.py:148: TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_knowledge_graph_integration.py:172: TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   assert 0 > 0
     +  where 0 = len([])
     +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6ae900200>.chunks
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_late_chunking_integration.py:77: assert 0 > 0
E   assert 0 >= 3
     +  where 0 = len([])
     +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6adc4c2f0>.chunks
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_late_chunking_integration.py:165: assert 0 >= 3
E   assert 0 >= 1
     +  where 0 = len([])
     +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6adbc7cb0>.chunks
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_late_chunking_integration.py:226: assert 0 >= 1
E   ValueError: Only 0 queries succeeded, minimum required: 1

During handling of the above exception, another exception occurred:
E   AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
------------------------------ Captured log call -------------------------------
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 0: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 1: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 2: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 0 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 1 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 2 failed: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.strategy:strategy.py:96 Multi-query retrieval failed: Only 0 queries succeeded, minimum required: 1
/mnt/MCPProyects/ragTools/rag_factory/strategies/multi_query/strategy.py:151: AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
E   ValueError: Only 0 queries succeeded, minimum required: 1

During handling of the above exception, another exception occurred:
E   AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
------------------------------ Captured log call -------------------------------
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 0: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 1: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 2: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 0 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 1 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 2 failed: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.strategy:strategy.py:96 Multi-query retrieval failed: Only 0 queries succeeded, minimum required: 1
/mnt/MCPProyects/ragTools/rag_factory/strategies/multi_query/strategy.py:151: AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
E   ValueError: Only 0 queries succeeded, minimum required: 1

During handling of the above exception, another exception occurred:
E   AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
------------------------------ Captured log call -------------------------------
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 0: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 1: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 2: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 3: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 4: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 0 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 1 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 2 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 3 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 4 failed: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.strategy:strategy.py:96 Multi-query retrieval failed: Only 0 queries succeeded, minimum required: 1
/mnt/MCPProyects/ragTools/rag_factory/strategies/multi_query/strategy.py:151: AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
E   ValueError: Only 0 queries succeeded, minimum required: 1

During handling of the above exception, another exception occurred:
E   AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
------------------------------ Captured log call -------------------------------
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 0: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 1: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 2: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 3: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 4: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 0 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 1 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 2 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 3 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 4 failed: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.strategy:strategy.py:96 Multi-query retrieval failed: Only 0 queries succeeded, minimum required: 1
/mnt/MCPProyects/ragTools/rag_factory/strategies/multi_query/strategy.py:151: AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
E   TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_multi_query_integration.py:189: TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'vector_store_service'
E   TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_multi_query_integration.py:211: TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   ValueError: Only 0 queries succeeded, minimum required: 1

During handling of the above exception, another exception occurred:
E   AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
------------------------------ Captured log call -------------------------------
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 0: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 1: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 2: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:134 Error executing variant 3: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 0 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 1 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 2 failed: Vector store must have 'asearch' or 'search' method
WARNING  rag_factory.strategies.multi_query.parallel_executor:parallel_executor.py:64 Query variant 3 failed: Vector store must have 'asearch' or 'search' method
ERROR    rag_factory.strategies.multi_query.strategy:strategy.py:96 Multi-query retrieval failed: Only 0 queries succeeded, minimum required: 1
/mnt/MCPProyects/ragTools/rag_factory/strategies/multi_query/strategy.py:151: AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
E   TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_multi_query_integration.py:268: TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
E   ValueError: MultiQueryRAGStrategy requires services: EMBEDDING, DATABASE
/mnt/MCPProyects/ragTools/rag_factory/strategies/base.py:178: ValueError: MultiQueryRAGStrategy requires services: EMBEDDING, DATABASE
E   assert 252.00581550598145 < 252.00581550598145
/mnt/MCPProyects/ragTools/tests/integration/strategies/test_query_expansion_integration.py:159: assert 252.00581550598145 < 252.00581550598145
=============================== warnings summary ===============================
rag_factory/services/llm/config.py:8
  /mnt/MCPProyects/ragTools/rag_factory/services/llm/config.py:8: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class LLMServiceConfig(BaseModel):

rag_factory/database/config.py:12
  /mnt/MCPProyects/ragTools/rag_factory/database/config.py:12: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DatabaseConfig(BaseSettings):

rag_factory/strategies/contextual/config.py:31
  /mnt/MCPProyects/ragTools/rag_factory/strategies/contextual/config.py:31: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ContextualRetrievalConfig(BaseModel):

rag_factory/strategies/late_chunking/models.py:21
  /mnt/MCPProyects/ragTools/rag_factory/strategies/late_chunking/models.py:21: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class TokenEmbedding(BaseModel):

rag_factory/strategies/late_chunking/models.py:34
  /mnt/MCPProyects/ragTools/rag_factory/strategies/late_chunking/models.py:34: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DocumentEmbedding(BaseModel):

rag_factory/strategies/late_chunking/models.py:49
  /mnt/MCPProyects/ragTools/rag_factory/strategies/late_chunking/models.py:49: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class EmbeddingChunk(BaseModel):

tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_end_to_end_workflow
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_end_to_end_workflow
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_end_to_end_workflow
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_retry_with_poor_results
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_retry_with_poor_results
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_retry_with_poor_results
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_performance_within_limits
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_performance_within_limits
tests/integration/strategies/test_self_reflective_integration.py::TestSelfReflectiveIntegration::test_performance_within_limits
  /mnt/MCPProyects/ragTools/rag_factory/strategies/self_reflective/strategy.py:174: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    result["refinements"] = [r.dict() for r in refinements]

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.3-final-0 ________________

Name                                                               Stmts   Miss  Cover   Missing
------------------------------------------------------------------------------------------------
rag_factory/__init__.py                                               37      9    76%   100-101, 107-109, 121-122, 130-131
rag_factory/__version__.py                                             1      0   100%
rag_factory/cli/__init__.py                                            2      0   100%
rag_factory/cli/commands/__init__.py                                   1      0   100%
rag_factory/cli/commands/benchmark.py                                 96     81    16%   40-53, 64-84, 148-263
rag_factory/cli/commands/check_consistency.py                         38     28    26%   64-113
rag_factory/cli/commands/config.py                                    78     68    13%   26-64, 102-188
rag_factory/cli/commands/index.py                                     65     52    20%   29-39, 93-185
rag_factory/cli/commands/query.py                                     47     36    23%   73-149
rag_factory/cli/commands/repl.py                                     153    132    14%   28-56, 63-108, 112-120, 124-133, 137-155, 159-172, 176-187, 191-208, 212-221, 254-261
rag_factory/cli/commands/strategies.py                                45     36    20%   48-120
rag_factory/cli/commands/validate_pipeline.py                         70     57    19%   57-156
rag_factory/cli/formatters/__init__.py                                 4      0   100%
rag_factory/cli/formatters/consistency.py                             61     55    10%   21-69, 79-103, 108-138
rag_factory/cli/formatters/output.py                                  20      9    55%   23-24, 43-44, 63-64, 74, 79, 84
rag_factory/cli/formatters/results.py                                 71     62    13%   28-55, 72-99, 116-144, 157-181
rag_factory/cli/formatters/validation.py                              63     53    16%   25-43, 48-56, 65-77, 86-98, 103-129, 134-137
rag_factory/cli/main.py                                               30     10    67%   25-28, 48-49, 74-76, 80
rag_factory/cli/utils/__init__.py                                      3      0   100%
rag_factory/cli/utils/progress.py                                     14      8    43%   34-47, 73-76
rag_factory/cli/utils/validation.py                                   53     42    21%   30-41, 57-77, 93-118, 135
rag_factory/config.py                                                155     99    36%   134-139, 189-191, 216-232, 247-266, 275, 301-310, 327-335, 357-369, 388-395, 416-440, 449-452, 464-469, 479, 496-498, 506-508, 521-526, 536-542
rag_factory/core/__init__.py                                           4      4     0%   7-23
rag_factory/core/capabilities.py                                      61     16    74%   129, 155, 173-174, 239-253
rag_factory/core/indexing_interface.py                                54     28    48%   144, 164, 208, 260, 272, 292-313, 341-364
rag_factory/core/pipeline.py                                          49     35    29%   22-24, 33-40, 55-77, 95-96, 105-108, 117-120, 137-146
rag_factory/core/retrieval_interface.py                               38     20    47%   56-58, 112-117, 138, 158, 196, 247, 259, 285-309
rag_factory/database/__init__.py                                       4      0   100%
rag_factory/database/config.py                                        17      0   100%
rag_factory/database/connection.py                                    80     54    32%   40-48, 61-86, 96, 107, 126-137, 150-157, 165-170, 178-183, 196-197, 209-214, 218, 222
rag_factory/database/env_validator.py                                 38     38     0%   7-139
rag_factory/database/models.py                                        85     32    62%   31-34, 37-45, 48-54, 66-69, 72-77, 80-85, 181, 323-325
rag_factory/database/vector_indexing.py                               38     38     0%   7-114
rag_factory/evaluation/__init__.py                                     4      4     0%   29-41
rag_factory/evaluation/analysis/__init__.py                            3      3     0%   8-11
rag_factory/evaluation/analysis/comparison.py                        135    135     0%   8-323
rag_factory/evaluation/analysis/statistics.py                         81     81     0%   8-320
rag_factory/evaluation/benchmarks/__init__.py                          3      3     0%   8-14
rag_factory/evaluation/benchmarks/config.py                           25     25     0%   7-64
rag_factory/evaluation/benchmarks/runner.py                          155    155     0%   8-423
rag_factory/evaluation/datasets/__init__.py                            3      3     0%   8-14
rag_factory/evaluation/datasets/loader.py                             88     88     0%   8-281
rag_factory/evaluation/datasets/schema.py                             52     52     0%   8-160
rag_factory/evaluation/datasets/statistics.py                         65     65     0%   8-226
rag_factory/evaluation/exporters/__init__.py                           4      4     0%   8-12
rag_factory/evaluation/exporters/csv_exporter.py                      52     52     0%   3-124
rag_factory/evaluation/exporters/html_exporter.py                     47     47     0%   3-293
rag_factory/evaluation/exporters/json_exporter.py                     19     19     0%   3-68
rag_factory/evaluation/metrics/__init__.py                             3      3     0%   12-25
rag_factory/evaluation/metrics/base.py                                31     31     0%   8-115
rag_factory/evaluation/metrics/cost.py                                65     65     0%   8-313
rag_factory/evaluation/metrics/performance.py                         42     42     0%   8-202
rag_factory/evaluation/metrics/quality.py                             84     84     0%   8-377
rag_factory/evaluation/metrics/retrieval.py                           77     77     0%   9-401
rag_factory/exceptions.py                                             13      0   100%
rag_factory/factory.py                                               187    141    25%   109-116, 144, 165-170, 202-230, 256-270, 300-324, 347-348, 365, 384, 401, 418, 435, 451-460, 480-502, 528-545, 568-611, 644-699, 703-715, 744-749
rag_factory/models/__init__.py                                         6      6     0%   3-14
rag_factory/models/embedding/__init__.py                               4      4     0%   3-12
rag_factory/models/embedding/loader.py                               179    179     0%   3-367
rag_factory/models/embedding/models.py                                47     47     0%   3-106
rag_factory/models/embedding/registry.py                             128    128     0%   3-282
rag_factory/models/evaluation/__init__.py                              3      3     0%   3-6
rag_factory/models/evaluation/ab_testing.py                           97     97     0%   3-279
rag_factory/models/evaluation/models.py                               29     29     0%   3-74
rag_factory/observability/__init__.py                                  3      0   100%
rag_factory/observability/integrations/__init__.py                     1      1     0%   3
rag_factory/observability/integrations/prometheus.py                  47     47     0%   3-229
rag_factory/observability/logging/__init__.py                          2      0   100%
rag_factory/observability/logging/config.py                           16     16     0%   3-37
rag_factory/observability/logging/filters.py                          41     41     0%   3-103
rag_factory/observability/logging/logger.py                           86     46    47%   49, 99-103, 108-115, 140-162, 190-229, 250, 270, 290-291, 306, 315, 324, 333, 344-373, 394-396
rag_factory/observability/metrics/__init__.py                          2      0   100%
rag_factory/observability/metrics/collector.py                       143     96    33%   66-68, 77-79, 88-90, 99, 108, 117, 128-143, 193-198, 221-266, 284-290, 304, 335-340, 352-364, 372-404, 442-443, 457-459
rag_factory/observability/metrics/cost.py                             39     39     0%   3-221
rag_factory/observability/metrics/performance.py                      64     64     0%   3-196
rag_factory/observability/monitoring/__init__.py                       1      1     0%   3
rag_factory/observability/monitoring/api.py                          101    101     0%   3-328
rag_factory/pipeline.py                                              156    118    24%   131-134, 160-167, 184-188, 205-209, 222-254, 277-312, 335-377, 402-406, 422-430, 444-450, 489-507
rag_factory/repositories/__init__.py                                   5      5     0%   20-31
rag_factory/repositories/base.py                                      42     42     0%   7-164
rag_factory/repositories/chunk.py                                    206    206     0%   7-670
rag_factory/repositories/document.py                                  93     93     0%   7-312
rag_factory/repositories/exceptions.py                                18     18     0%   7-77
rag_factory/services/__init__.py                                       8      0   100%
rag_factory/services/api/__init__.py                                   4      0   100%
rag_factory/services/api/anthropic.py                                 27     18    33%   46-52, 76-94, 118-141
rag_factory/services/api/cohere.py                                    30     19    37%   14-15, 49-59, 82-113
rag_factory/services/api/openai.py                                    46     31    33%   45-51, 75-93, 117-140, 168-174, 189-199, 216-227, 235
rag_factory/services/consistency.py                                   32     24    25%   80-113, 144-170
rag_factory/services/database/__init__.py                              3      0   100%
rag_factory/services/database/neo4j.py                                54     36    33%   14, 60-71, 79-84, 103-114, 134-150, 172-181, 188-191, 195, 199
rag_factory/services/database/postgres.py                             91     71    22%   17-18, 72-87, 97-111, 115-139, 152-185, 209-242, 256-271, 286-301, 333-351, 358-361, 365, 369
rag_factory/services/dependencies.py                                  41     10    76%   99, 103, 107, 134-140, 179-180
rag_factory/services/embedding/__init__.py                             4      0   100%
rag_factory/services/embedding/base.py                                31      6    81%   44, 59, 68, 77, 86, 98
rag_factory/services/embedding/cache.py                               43     33    23%   26-32, 43-58, 67-76, 80-82, 90-94
rag_factory/services/embedding/config.py                              29     13    55%   37-43, 50-68, 80
rag_factory/services/embedding/providers/__init__.py                   5      0   100%
rag_factory/services/embedding/providers/cohere.py                    53     36    32%   10-20, 55-75, 90-117, 125, 133, 141, 152-153
rag_factory/services/embedding/providers/local.py                     43     27    37%   8-9, 46-67, 83-109, 117, 125, 133, 146
rag_factory/services/embedding/providers/onnx_local.py               116     92    21%   18-19, 24-25, 89-184, 200-250, 261-308, 319, 327, 335, 348
rag_factory/services/embedding/providers/openai.py                    51     34    33%   10-20, 53-72, 87-108, 116, 124, 132, 143-144
rag_factory/services/embedding/rate_limiter.py                        20      1    95%   32
rag_factory/services/embedding/service.py                            100     83    17%   50-62, 79-93, 117-198, 220-222, 233-239, 248-266, 273-275
rag_factory/services/interfaces.py                                    35      0   100%
rag_factory/services/llm/__init__.py                                   5      0   100%
rag_factory/services/llm/base.py                                      43      0   100%
rag_factory/services/llm/config.py                                    23      6    74%   46-48, 51-53
rag_factory/services/llm/prompt_template.py                           43     24    44%   47-82, 97-100, 111-115
rag_factory/services/llm/providers/__init__.py                        12     10    17%   10-22
rag_factory/services/llm/providers/anthropic.py                       57     42    26%   44-50, 64-97, 120-147, 171-172, 184-189, 197, 205
rag_factory/services/llm/providers/ollama.py                          55     42    24%   22-24, 37-67, 93-122, 142-143, 157, 165, 174, 185-196
rag_factory/services/llm/providers/openai.py                          57     20    65%   56, 62, 101-105, 133-158, 189-194, 202, 210
rag_factory/services/llm/service.py                                   66     25    62%   68, 94, 127-129, 154-175, 186, 194-198, 215-216
rag_factory/services/llm/token_counter.py                             27      4    85%   56-57, 71-72
rag_factory/services/local/__init__.py                                 2      0   100%
rag_factory/services/local/reranker.py                                32     22    31%   13-14, 45-52, 78-116
rag_factory/services/onnx/__init__.py                                  2      0   100%
rag_factory/services/onnx/embedding.py                                29     19    34%   54-68, 83-93, 110-121, 129
rag_factory/services/utils/__init__.py                                 2      0   100%
rag_factory/services/utils/model_converter.py                        104    104     0%   8-291
rag_factory/services/utils/onnx_utils.py                             171    106    38%   22-23, 28-29, 41, 48, 94, 100-101, 106-107, 123-193, 213-234, 263, 277-278, 282, 286-289, 304-306, 328-362, 420-435, 448-466, 480-492
rag_factory/services/utils/reranker_selector.py                       68     68     0%   8-249
rag_factory/strategies/__init__.py                                     2      0   100%
rag_factory/strategies/agentic/__init__.py                             7      7     0%   8-20
rag_factory/strategies/agentic/agent.py                              151    151     0%   8-420
rag_factory/strategies/agentic/config.py                              12     12     0%   5-31
rag_factory/strategies/agentic/frameworks/__init__.py                  1      1     0%   9
rag_factory/strategies/agentic/query_analyzer.py                      89     89     0%   8-278
rag_factory/strategies/agentic/strategy.py                            76     76     0%   8-247
rag_factory/strategies/agentic/tool_implementations.py               135    135     0%   11-511
rag_factory/strategies/agentic/tools.py                               40     40     0%   8-142
rag_factory/strategies/base.py                                        55      6    89%   80-85
rag_factory/strategies/chunking/__init__.py                           15      4    73%   45-48
rag_factory/strategies/chunking/base.py                               91     15    84%   116, 122, 128, 159, 171, 191-196, 211, 215, 229, 250-252
rag_factory/strategies/chunking/docling_chunker.py                    45     26    42%   18, 61-73, 89-101, 112, 131-136, 147-152, 163-168, 186-188
rag_factory/strategies/chunking/fixed_size_chunker.py                 74     35    53%   8-9, 36-40, 44-46, 59, 74-95, 122, 146, 171-185, 199-204
rag_factory/strategies/chunking/hybrid_chunker.py                     70     58    17%   36-48, 63-132, 143, 157-160, 173-192
rag_factory/strategies/chunking/semantic_chunker.py                  195    171    12%   9-10, 14-15, 45-71, 83-128, 139, 155-156, 172-177, 193-206, 218-227, 245-277, 293-328, 340-386, 397-423, 434-441, 459-473, 485-534
rag_factory/strategies/chunking/structural_chunker.py                147     50    66%   9-10, 40-44, 48-50, 121, 127-130, 222-288, 305, 325, 332-346, 380-385, 400, 406, 413, 423
rag_factory/strategies/chunking/utils.py                              89     89     0%   3-264
rag_factory/strategies/contextual/__init__.py                          7      0   100%
rag_factory/strategies/contextual/batch_processor.py                  86     71    17%   41-43, 60-73, 85-91, 109-129, 146-162, 179-200, 217-257
rag_factory/strategies/contextual/config.py                           46      0   100%
rag_factory/strategies/contextual/context_generator.py                84     70    17%   35-36, 59-99, 112-135, 152-194, 209, 224-234
rag_factory/strategies/contextual/cost_tracker.py                     32     21    34%   31-35, 48-51, 69-82, 94-99, 111-114, 126
rag_factory/strategies/contextual/prompts.py                          25     17    32%   85-106, 119
rag_factory/strategies/contextual/storage.py                          44     35    20%   32-33, 42-45, 54-81, 98-118
rag_factory/strategies/contextual/strategy.py                         63     39    38%   51-64, 72, 93-140, 157, 170, 191-199, 215-242, 247, 252, 261
rag_factory/strategies/fine_tuned/__init__.py                          4      4     0%   1-5
rag_factory/strategies/fine_tuned/ab_testing.py                       78     78     0%   1-134
rag_factory/strategies/fine_tuned/config.py                           11     11     0%   1-30
rag_factory/strategies/fine_tuned/custom_loader.py                    40     40     0%   1-88
rag_factory/strategies/fine_tuned/model_registry.py                  126    126     0%   1-303
rag_factory/strategies/hierarchical/__init__.py                        5      0   100%
rag_factory/strategies/hierarchical/hierarchy_builder.py              79     65    18%   35-36, 49-75, 92-93, 113-149, 167-201, 220, 249-281, 310-335
rag_factory/strategies/hierarchical/models.py                         58      0   100%
rag_factory/strategies/hierarchical/parent_retriever.py               89     77    13%   38-40, 56-92, 103-113, 130-149, 166-196, 213-227, 250-257, 268-278
rag_factory/strategies/hierarchical/strategy.py                       63     48    24%   45-70, 83, 94-126, 144-152, 180-214, 228, 242-243, 259-275
rag_factory/strategies/indexing/__init__.py                            5      0   100%
rag_factory/strategies/indexing/context_aware.py                      97     79    19%   29, 40, 60-120, 141-142, 146-156, 168-174, 178-184, 194-223, 227-228
rag_factory/strategies/indexing/hierarchical.py                       83      1    99%   264
rag_factory/strategies/indexing/in_memory.py                          41      0   100%
rag_factory/strategies/indexing/keyword_indexing.py                   40     31    22%   40, 51, 75-155
rag_factory/strategies/indexing/vector_embedding.py                   29      1    97%   56
rag_factory/strategies/knowledge_graph/__init__.py                     4      0   100%
rag_factory/strategies/knowledge_graph/config.py                      21      2    90%   128-129
rag_factory/strategies/knowledge_graph/entity_extractor.py            70     56    20%   34-36, 53-74, 89, 96-119, 128-166, 178-205
rag_factory/strategies/knowledge_graph/graph_store.py                 31      9    71%   25, 35, 48, 66, 86, 99, 109, 114, 124
rag_factory/strategies/knowledge_graph/hybrid_retriever.py            56     45    20%   35-42, 61-97, 101-108, 117-164
rag_factory/strategies/knowledge_graph/memory_graph_store.py          97     80    18%   23-25, 29-38, 42-53, 60, 68-87, 96-152, 161-168, 172-182, 186-189, 193-196
rag_factory/strategies/knowledge_graph/models.py                      53      0   100%
rag_factory/strategies/knowledge_graph/relationship_extractor.py      62     50    19%   35-37, 56-85, 93-122, 132-189
rag_factory/strategies/knowledge_graph/strategy.py                    73     49    33%   44-63, 75, 94-154, 179-201, 210-220, 224, 228, 232, 237, 242
rag_factory/strategies/late_chunking/__init__.py                       6      0   100%
rag_factory/strategies/late_chunking/coherence_analyzer.py            27      5    81%   59, 82-96
rag_factory/strategies/late_chunking/document_embedder.py             99     36    64%   35, 56, 62-63, 72, 111, 220-228, 249-272, 289-296, 311
rag_factory/strategies/late_chunking/embedding_chunker.py            112     21    81%   53, 57, 122-125, 133-139, 164, 177-178, 201-211, 215-225, 284
rag_factory/strategies/late_chunking/models.py                        62      0   100%
rag_factory/strategies/late_chunking/strategy.py                      49      6    88%   48, 124-133
rag_factory/strategies/multi_query/__init__.py                         7      0   100%
rag_factory/strategies/multi_query/config.py                          36      0   100%
rag_factory/strategies/multi_query/deduplicator.py                    87     75    14%   41-100, 116-176, 188-197
rag_factory/strategies/multi_query/parallel_executor.py               52     11    79%   74-75, 84-86, 116-118, 128-132, 148, 154-155
rag_factory/strategies/multi_query/prompts.py                         10      2    80%   76-80
rag_factory/strategies/multi_query/ranker.py                          80     67    16%   35-70, 81-84, 98-103, 116-126, 141-177, 189-201
rag_factory/strategies/multi_query/strategy.py                        62     15    76%   86-93, 103, 107, 111, 130-134, 140, 152-158, 170, 175
rag_factory/strategies/multi_query/variant_generator.py               62     14    77%   71-79, 115-129, 177, 182
rag_factory/strategies/query_expansion/__init__.py                     8      0   100%
rag_factory/strategies/query_expansion/base.py                        66      3    95%   103, 115, 118
rag_factory/strategies/query_expansion/cache.py                       52     25    52%   47-51, 70-73, 81-97, 105-112
rag_factory/strategies/query_expansion/expander_service.py            91      3    97%   171, 276-277
rag_factory/strategies/query_expansion/hyde_expander.py               19      1    95%   48
rag_factory/strategies/query_expansion/llm_expander.py                25      0   100%
rag_factory/strategies/query_expansion/metrics.py                     66     30    55%   44-45, 53-57, 76-109, 130, 134, 146-152, 160
rag_factory/strategies/query_expansion/prompts.py                     13      1    92%   29
rag_factory/strategies/reranking/__init__.py                           7      0   100%
rag_factory/strategies/reranking/base.py                              68     16    76%   81, 101, 106, 110-119, 123-130
rag_factory/strategies/reranking/bge_reranker.py                      51     37    27%   14, 53-81, 103-147, 151
rag_factory/strategies/reranking/cache.py                             48     17    65%   60-63, 81, 90-101, 110-113
rag_factory/strategies/reranking/cohere_reranker.py                   34     20    41%   15-16, 55-71, 94-115, 119
rag_factory/strategies/reranking/cosine_reranker.py                   62     47    24%   54-72, 97-139, 158-171, 188, 209-215, 227-230, 242-245, 249
rag_factory/strategies/reranking/cross_encoder_reranker.py            40     27    32%   13-14, 53-76, 98-120, 124
rag_factory/strategies/reranking/metrics.py                           67     67     0%   8-264
rag_factory/strategies/reranking/reranker_service.py                 115     15    87%   80, 84-89, 118, 137, 167, 203-204, 225, 269, 308-310
rag_factory/strategies/self_reflective/__init__.py                     6      0   100%
rag_factory/strategies/self_reflective/config.py                      20      8    60%   29-42
rag_factory/strategies/self_reflective/grader.py                      80     11    86%   52-53, 106-109, 221, 234-237, 248-249
rag_factory/strategies/self_reflective/models.py                      48      0   100%
rag_factory/strategies/self_reflective/refiner.py                     69     12    83%   93-96, 114, 127, 129, 131, 163-165, 221-222
rag_factory/strategies/self_reflective/strategy.py                    89      7    92%   79-80, 154-155, 194, 259, 264
rag_factory/utils/__init__.py                                          3      0   100%
rag_factory/utils/token_counter.py                                    45     30    33%   36-40, 52-62, 74-82, 86, 90, 105-106, 124-135, 153-158
rag_factory/utils/tokenization.py                                     95     73    23%   36-40, 53-64, 87-114, 126-129, 141-144, 156, 175-190, 209-228, 241-243, 251-252, 270-271, 292-293, 314-315
------------------------------------------------------------------------------------------------
TOTAL                                                              11070   7506    32%
=========================== short test summary info ============================
FAILED tests/integration/strategies/test_base_integration.py::test_strategy_full_lifecycle - TypeError: Can't instantiate abstract class DummyStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_base_integration.py::test_multiple_strategies_implement_interface - TypeError: Can't instantiate abstract class StrategyA without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_base_integration.py::test_async_retrieve_works - TypeError: Can't instantiate abstract class AsyncStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_base_integration.py::test_strategy_error_handling - TypeError: Can't instantiate abstract class ErrorStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_base_integration.py::test_strategy_configuration_override - TypeError: Can't instantiate abstract class ConfigurableStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_contextual_integration.py::test_contextual_retrieval_complete_workflow - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_contextual_integration.py::test_cost_tracking_accuracy - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_contextual_integration.py::test_retrieval_with_different_formats - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_contextual_integration.py::test_error_recovery - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_contextual_integration.py::test_synchronous_indexing - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_contextual_integration.py::test_large_document_processing - TypeError: Can't instantiate abstract class ContextualRetrievalStrategy without an implementation for abstract method 'aretrieve'
FAILED tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_end_to_end_workflow - TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_expansion_strategy_comparison - TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_hierarchy_validation - TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_hierarchical_integration.py::TestHierarchicalIntegration::test_multiple_documents - TypeError: Can't instantiate abstract class HierarchicalRAGStrategy without an implementation for abstract method 'requires_services'
FAILED tests/integration/strategies/test_knowledge_graph_integration.py::test_knowledge_graph_workflow - TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_knowledge_graph_integration.py::test_hybrid_retrieval - TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_knowledge_graph_integration.py::test_relationship_queries - TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_knowledge_graph_integration.py::test_graph_statistics - TypeError: KnowledgeGraphRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_late_chunking_integration.py::test_late_chunking_workflow - assert 0 > 0
 +  where 0 = len([])
 +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6ae900200>.chunks
FAILED tests/integration/strategies/test_late_chunking_integration.py::test_multiple_documents - assert 0 >= 3
 +  where 0 = len([])
 +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6adc4c2f0>.chunks
FAILED tests/integration/strategies/test_late_chunking_integration.py::test_short_document - assert 0 >= 1
 +  where 0 = len([])
 +    where [] = <tests.integration.strategies.test_late_chunking_integration.MockVectorStore object at 0x72f6adbc7cb0>.chunks
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_multi_query_complete_workflow - AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_multi_query_async_workflow - AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_variant_diversity - AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_performance_requirements - AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_fallback_on_failure - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_ranking_strategy_comparison - TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_deduplication_across_variants - AttributeError: 'MultiQueryRAGStrategy' object has no attribute 'vector_store'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryIntegration::test_strategy_properties - TypeError: MultiQueryRAGStrategy.__init__() got an unexpected keyword argument 'vector_store_service'
FAILED tests/integration/strategies/test_multi_query_integration.py::TestMultiQueryWithLMStudio::test_with_real_llm - ValueError: MultiQueryRAGStrategy requires services: EMBEDDING, DATABASE
FAILED tests/integration/strategies/test_query_expansion_integration.py::TestQueryExpansionIntegration::test_cache_functionality - assert 252.00581550598145 < 252.00581550598145
ERROR tests/integration/strategies/test_keyword_indexing.py::test_capabilities - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
ERROR tests/integration/strategies/test_keyword_indexing.py::test_dependencies - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
ERROR tests/integration/strategies/test_keyword_indexing.py::test_process_success - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
ERROR tests/integration/strategies/test_keyword_indexing.py::test_process_no_chunks - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
ERROR tests/integration/strategies/test_keyword_indexing.py::test_process_empty_text - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
ERROR tests/integration/strategies/test_keyword_indexing.py::test_process_stop_words_only - TypeError: StrategyDependencies.__init__() got an unexpected keyword argument 'reranking_service'
== 32 failed, 71 passed, 1 skipped, 15 warnings, 6 errors in 65.16s (0:01:05) ==

✓ Results saved to: test_results.txt
